<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>D√©verrouillage s√©curis√© + QCM</title>
<style>
/* ===== Header ===== */
body{margin:0;font-family:'Segoe UI',Tahoma,sans-serif;}
header{background:#2563eb;color:white;padding:15px 30px;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:100;}
header .logo{font-size:24px;font-weight:bold;}
header nav a{color:white;margin-left:15px;text-decoration:none;font-weight:500;}
header nav a.active{text-decoration:underline;}

/* ===== D√©verrouillage ===== */
*{box-sizing:border-box;}
body{height:100vh;display:flex;flex-direction:column;align-items:center;background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);}
#lock-screen{
    width:360px;padding:40px 30px;background:rgba(255,255,255,0.12);backdrop-filter:blur(12px);border-radius:18px;box-shadow:0 20px 40px rgba(0,0,0,0.4);text-align:center;color:#fff;margin-top:40px;
}
#lock-screen img{width:70px;margin-bottom:20px;}
#lock-screen input{width:100%;padding:15px;border-radius:10px;border:none;margin-bottom:20px;font-size:16px;text-align:center;letter-spacing:4px;}
#lock-screen button{width:100%;padding:14px;border:none;border-radius:10px;background:#00c6ff;font-weight:bold;cursor:pointer;}
#lock-msg{margin-top:18px;height:18px;}

/* ===== QCM ===== */
#quiz-screen{display:none;}
:root{--blue:#2563eb;--green:#16a34a;--red:#dc2626;--bg:#f1f5f9;}
.container{background:#fff;width:100%;max-width:800px;padding:30px;border-radius:16px;box-shadow:0 15px 40px rgba(0,0,0,.15);margin-top:40px;}
h1{text-align:center;color:var(--blue);margin-bottom:10px;}
.top-bar{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;}
.timer{font-size:20px;font-weight:bold;color:#0f172a;background:#e0e7ff;padding:8px 16px;border-radius:999px;}
.progress{font-weight:600;color:#475569;}
.question{font-size:26px;font-weight:700;margin-bottom:25px;color:#020617;}
.option{display:block;width:100%;text-align:left;padding:14px 18px;margin:12px 0;font-size:18px;border-radius:10px;border:2px solid #e5e7eb;background:#f8fafc;cursor:pointer;transition:.2s;}
.option:hover{border-color:var(--blue);background:#eef2ff;}
.correct{background:#dcfce7 !important;border-color:var(--green) !important;color:#14532d;}
.wrong{background:#fee2e2 !important;border-color:var(--red) !important;color:#7f1d1d;}
#result{text-align:center;font-size:24px;font-weight:700;margin-top:20px;}
#restart{display:none;margin:25px auto 0;padding:12px 24px;font-size:18px;border:none;border-radius:999px;background:var(--blue);color:#fff;cursor:pointer;}
#recent-scores{margin-top:20px;font-size:16px;color:#020617;text-align:center;}
</style>
</head>
<body>

<!-- Header ZAGA -->
<header>
    <nav>
        <a href="index.html">HOMEüë®üèΩ‚Äçüíª</a>
        <a href="cours.html">COURSüìñ</a>
        <a class="active" href="exo.html">EXAMENüìù</a>
    </nav>
</header>

<!-- √âCRAN D√âVERROUILLAGE -->
<div id="lock-screen">
    <img src="https://cdn-icons-png.flaticon.com/512/3064/3064155.png" alt="Lock">
    <h2>D√©verrouillage</h2>
    <input type="password" id="pin" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
    <button id="btn" onclick="unlock()">D√©verrouiller</button>
    <div class="msg" id="lock-msg"></div>
</div>

<!-- QCM -->
<div id="quiz-screen" class="container">
    <h1>QCM Cybers√©curit√©</h1>
    <div class="top-bar">
        <div class="progress" id="progress"></div>
        <div class="timer" id="timer">15:00</div>
    </div>
    <div id="quiz"></div>
    <div id="result"></div>
    <button id="restart" onclick="startQuiz()">üîÑ Red√©marrer le QCM</button>
    <div id="recent-scores"></div>
</div>

<script>
/* ===== D√âVERROUILLAGE ===== */
const PIN_CORRECT = "7183";
let tentatives = 0;
const MAX_TENTATIVES = 5; // üîë 5 tentatives avant blocage

function unlock() {
    const pin = document.getElementById("pin").value;
    const msg = document.getElementById("lock-msg");
    const btn = document.getElementById("btn");

    if (tentatives >= MAX_TENTATIVES) {
        msg.style.color = "#ff4d4d";
        msg.textContent = "üîí Acc√®s bloqu√©"; 
        btn.disabled = true;
        return;
    }

    if (pin === PIN_CORRECT) {
        msg.style.color = "#00ff9d";
        msg.textContent = "‚úî Acc√®s autoris√©";
        setTimeout(() => {
            document.getElementById("lock-screen").style.display = "none";
            document.getElementById("quiz-screen").style.display = "block";
            startQuiz();
        }, 300);
    } else {
        tentatives++;
        msg.style.color = "#ff4d4d";
        if (tentatives < MAX_TENTATIVES) {
            msg.textContent = `Mot de passe incorrect (${tentatives}/${MAX_TENTATIVES})`;
        } else {
            msg.textContent = "üîí Acc√®s bloqu√©";
            btn.disabled = true;
        }
    }

    document.getElementById("pin").value = "";
}

/* ===== RE-VERROUILLAGE ===== */
function relock(reason=""){
    clearInterval(timerInterval);
    document.getElementById("quiz-screen").style.display="none";
    document.getElementById("lock-screen").style.display="block";
    document.getElementById("lock-msg").style.color="#ffcc00";
    document.getElementById("lock-msg").textContent = reason || "üîê Session verrouill√©e";
    document.getElementById("pin").value="";
}

// Quitter ou changer d‚Äôonglet
window.addEventListener("beforeunload", function () { relock("üîê Vous avez quitt√© la page"); });
document.addEventListener("visibilitychange", function () {
    if(document.hidden && document.getElementById("quiz-screen").style.display==="block"){
        relock("üîê Changement d‚Äôonglet d√©tect√©");
    }
});

/* ===== QUESTIONS QCM SANS NUM√âRO ===== */
const questions=[
 {q:"La cybers√©curit√© prot√®ge uniquement les donn√©es personnelles des individus.",a:false},
 {q:"Les niveaux de protection incluent le personnel, le professionnel et le gouvernemental.",a:true},
 {q:"L'usurpation d'identit√© est un risque li√© aux donn√©es personnelles.",a:true},
 {q:"Les donn√©es IoT augmentent le risque de violations de s√©curit√©.",a:true},
 {q:"Le Cube de McCumber inclut confidentialit√©, int√©grit√© et disponibilit√©.",a:true},
 {q:"Les hackers chapeau noir testent la s√©curit√© avec autorisation.",a:false},
 {q:"Les menaces internes peuvent provenir d'employ√©s involontaires.",a:true},
 {q:"Stuxnet est un malware utilis√© uniquement pour espionner les emails.",a:false},
 {q:"Les violations de donn√©es peuvent entra√Æner des pertes financi√®res.",a:true},
 {q:"Un ransomware chiffre les donn√©es et exige une ran√ßon.",a:true},
 {q:"Un ver n√©cessite l'action de l'utilisateur pour se propager.",a:false},
 {q:"Le rootkit est facile √† d√©tecter.",a:false},
 {q:"L'ing√©nierie sociale exploite la psychologie humaine.",a:true},
 {q:"Une attaque DDoS provient d'une seule machine.",a:false},
 {q:"Les botnets sont des r√©seaux d'appareils zombies.",a:true},
 {q:"Le cryptojacking mine des cryptomonnaies sans consentement.",a:true},
 {q:"Les mises √† jour sont inutiles avec un antivirus.",a:false},
 {q:"Le chiffrement prot√®ge contre l'acc√®s non autoris√©.",a:true},
 {q:"Le 2FA renforce la s√©curit√©.",a:true},
 {q:"OAuth √©vite de partager son mot de passe.",a:true},
 {q:"Un mot de passe fort doit √™tre long et complexe.",a:true},
 {q:"La navigation priv√©e rend totalement anonyme.",a:false},
 {q:"Un pare-feu filtre le trafic r√©seau.",a:true},
 {q:"IDS bloque automatiquement le trafic.",a:false},
 {q:"Un VPN cr√©e un tunnel chiffr√©.",a:true},
 {q:"Les honeypots attirent les attaquants.",a:true},
 {q:"Les tests d'intrusion ne n√©cessitent pas d'autorisation.",a:false},
 {q:"La gestion des risques inclut identification et r√©ponse.",a:true},
 {q:"La r√©ponse aux incidents inclut la communication.",a:true},
 {q:"Une seule couche de s√©curit√© suffit.",a:false},
 {q:"CEH concerne le hacking √©thique.",a:true},
 {q:"CISSP exige environ 5 ans d'exp√©rience.",a:true},
 {q:"Les certifications am√©liorent l'employabilit√©.",a:true},
 {q:"CyberSeek analyse le march√© de l'emploi cyber.",a:true},
 {q:"L'√©thique est inutile en cybers√©curit√©.",a:false},
 {q:"Le Wi-Fi public sans VPN est s√©curis√©.",a:false},
 {q:"Les sauvegardes √©vitent les pertes de donn√©es.",a:true},
 {q:"D√©truire physiquement un disque est s√ªr.",a:true},
 {q:"Le phishing peut se faire par email.",a:true},
 {q:"Les APT sont des attaques avanc√©es.",a:true},
 {q:"Spyware et adware peuvent coexister.",a:true},
 {q:"Les pentests r√©v√®lent des failles.",a:true},
 {q:"Spectre/Meltdown exploitent le mat√©riel.",a:true},
 {q:"EFS prot√®ge les donn√©es en transit.",a:false},
 {q:"La cybers√©curit√© est une responsabilit√© partag√©e.",a:true},
 {q:"Un antivirus bloque tous les malwares.",a:false},
 {q:"Le MFA est plus s√ªr qu‚Äôun mot de passe seul.",a:true},
 {q:"Les vuln√©rabilit√©s zero-day sont connues des √©diteurs.",a:false},
 {q:"L'authentification biom√©trique peut remplacer les mots de passe.",a:false},
 {q:"Le phishing vocal s'appelle vishing.",a:true},
 {q:"Le spear-phishing cible des individus pr√©cis.",a:true},
 {q:"Les mots de passe doivent √™tre chang√©s r√©guli√®rement.",a:true},
 {q:"Le Wi-Fi WPA2 est plus s√©curis√© que WEP.",a:true},
 {q:"Les logs r√©seau aident √† d√©tecter les attaques.",a:true},
 {q:"Le Social Engineering ne concerne que les emails.",a:false},
 {q:"Un honeypot est un leurre pour hackers.",a:true},
 {q:"La conformit√© RGPD prot√®ge la vie priv√©e.",a:true},
 {q:"La segmentation r√©seau limite la propagation des attaques.",a:true},
 {q:"Les sauvegardes cloud sont toujours crypt√©es.",a:false},
 {q:"Les IDS d√©tectent les intrusions en temps r√©el.",a:true},
 {q:"Une attaque MITM intercepte les communications.",a:true},
 {q:"La cybers√©curit√© est un investissement, pas une d√©pense.",a:true},
 {q:"Les scripts Kiddies ont peu de comp√©tences.",a:true},
 {q:"Le ransomware peut chiffrer des serveurs entiers.",a:true},
 {q:"La sensibilisation du personnel r√©duit les risques.",a:true},
 {q:"Les VPN gratuits sont toujours s√ªrs.",a:false},
 {q:"Les certificats SSL/TLS s√©curisent les sites web.",a:true},
 {q:"Les tests d'intrusion doivent √™tre document√©s.",a:true},
 {q:"Les APT peuvent rester longtemps invisibles.",a:true},
 {q:"La cybers√©curit√© doit √©voluer constamment.",a:true}
];

/* ===== VARIABLES QCM ===== */
let current=0, score=0, timeLeft=900, timerInterval;

/* ===== SHUFFLE QUESTIONS ===== */
function shuffleQuestions(array){
    for(let i=array.length-1;i>0;i--){
        const j=Math.floor(Math.random()*(i+1));
        [array[i], array[j]]=[array[j], array[i]];
    }
}

/* ===== SAUVEGARDE SCORES ===== */
function saveRecentScore(note){
    let scores = JSON.parse(localStorage.getItem("recentScores")) || [];
    scores.unshift(note);
    if(scores.length>5) scores.pop();
    localStorage.setItem("recentScores", JSON.stringify(scores));
}
function showRecentScores(){
    let scores = JSON.parse(localStorage.getItem("recentScores")) || [];
    document.getElementById("recent-scores").innerHTML = 
        scores.length ? `üíæ Derni√®res notes : ${scores.join(" / ")}` : 
        `üíæ Pas encore de notes sauvegard√©es`;
}

/* ===== START QUIZ ===== */
function startQuiz(){
    current=0; score=0; timeLeft=900;
    shuffleQuestions(questions); 
    document.getElementById("result").innerHTML="";
    document.getElementById("restart").style.display="none";
    startTimer();
    showQuestion();
}

/* ===== TIMER ===== */
function startTimer(){
    clearInterval(timerInterval);
    timerInterval=setInterval(()=>{
        let m=Math.floor(timeLeft/60);
        let s=timeLeft%60;
        document.getElementById("timer").textContent=
            `${String(m).padStart(2,"0")}:${String(s).padStart(2,"0")}`;
        timeLeft--;
        if(timeLeft<0){ relock("‚è± Temps √©coul√© ‚Äì examen termin√©"); }
    },1000);
}

/* ===== QUESTIONS ===== */
function showQuestion(){
    if(current>=questions.length){ endQuiz(); return; }
    document.getElementById("progress").textContent=
        `Question ${current+1} / ${questions.length}`;
    document.getElementById("quiz").innerHTML=`
        <div class="question">${questions[current].q}</div>
        <button class="option" onclick="answer(true,this)">‚úÖ Vrai</button>
        <button class="option" onclick="answer(false,this)">‚ùå Faux</button>
    `;
}

function answer(val,btn){
    let correct=questions[current].a;
    if(val===correct){ btn.classList.add("correct"); score++; }
    else{ btn.classList.add("wrong"); }
    document.querySelectorAll(".option").forEach(b=>b.disabled=true);
    setTimeout(()=>{ current++; showQuestion(); },700);
}

/* ===== FIN QUIZ ===== */
function endQuiz(){
    clearInterval(timerInterval);
    let noteSur20 = ((score / questions.length) * 20).toFixed(2);
    saveRecentScore(noteSur20);
    showRecentScores();
    document.getElementById("quiz").innerHTML="";
    document.getElementById("progress").textContent="QCM termin√©";
    document.getElementById("result").innerHTML=
        `üéØ Score : ${score} / ${questions.length}<br>üìä Note : <b>${noteSur20} / 20</b>`;
    document.getElementById("restart").style.display="block";
}

/* ===== AFFICHAGE SCORES INIT ===== */
showRecentScores();
</script>
</body>
</html>
